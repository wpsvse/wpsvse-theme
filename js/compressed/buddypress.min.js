function bp_init_activity(){jq.cookie("bp-activity-oldestpage",1,{path:"/"}),null!=jq.cookie("bp-activity-filter")&&jq("#activity-filter-select").length&&jq('#activity-filter-select select option[value="'+jq.cookie("bp-activity-filter")+'"]').prop("selected",!0),null!=jq.cookie("bp-activity-scope")&&jq(".activity-type-tabs").length&&(jq(".activity-type-tabs li").each(function(){jq(this).removeClass("selected")}),jq("#activity-"+jq.cookie("bp-activity-scope")+", .item-list-tabs li.current").addClass("selected"))}function bp_init_objects(e){jq(e).each(function(t){null!=jq.cookie("bp-"+e[t]+"-filter")&&jq("#"+e[t]+"-order-select select").length&&jq("#"+e[t]+'-order-select select option[value="'+jq.cookie("bp-"+e[t]+"-filter")+'"]').prop("selected",!0),null!=jq.cookie("bp-"+e[t]+"-scope")&&jq("div."+e[t]).length&&(jq(".item-list-tabs li").each(function(){jq(this).removeClass("selected")}),jq("#"+e[t]+"-"+jq.cookie("bp-"+e[t]+"-scope")+", #object-nav li.current").addClass("selected"))})}function bp_filter_request(e,t,i,a,s,n,o,r,l){return"activity"===e?!1:(null===i&&(i="all"),jq.cookie("bp-"+e+"-scope",i,{path:"/"}),jq.cookie("bp-"+e+"-filter",t,{path:"/"}),jq.cookie("bp-"+e+"-extras",o,{path:"/"}),jq(".item-list-tabs li").each(function(){jq(this).removeClass("selected")}),jq("#"+e+"-"+i+", #object-nav li.current").addClass("selected"),jq(".item-list-tabs li.selected").addClass("loading"),jq('.item-list-tabs select option[value="'+t+'"]').prop("selected",!0),("friends"===e||"group_members"===e)&&(e="members"),bp_ajax_request&&bp_ajax_request.abort(),void(bp_ajax_request=jq.post(ajaxurl,{action:e+"_filter",cookie:bp_get_cookies(),object:e,filter:t,search_terms:s,scope:i,page:n,extras:o,template:l},function(e){if("pag-bottom"===r&&jq("#subnav").length){var t=jq("#subnav").parent();jq("html,body").animate({scrollTop:t.offset().top},"slow",function(){jq(a).fadeOut(100,function(){jq(this).html(e),jq(this).fadeIn(100)})})}else jq(a).fadeOut(100,function(){jq(this).html(e),jq(this).fadeIn(100)});jq(".item-list-tabs li.selected").removeClass("loading")})))}function bp_activity_request(e,t){jq.cookie("bp-activity-scope",e,{path:"/"}),jq.cookie("bp-activity-filter",t,{path:"/"}),jq.cookie("bp-activity-oldestpage",1,{path:"/"}),jq(".item-list-tabs li").each(function(){jq(this).removeClass("selected loading")}),jq("#activity-"+e+", .item-list-tabs li.current").addClass("selected"),jq("#object-nav.item-list-tabs li.selected, div.activity-type-tabs li.selected").addClass("loading"),jq('#activity-filter-select select option[value="'+t+'"]').prop("selected",!0),jq(".widget_bp_activity_widget h2 span.ajax-loader").show(),bp_ajax_request&&bp_ajax_request.abort(),bp_ajax_request=jq.post(ajaxurl,{action:"activity_widget_filter",cookie:bp_get_cookies(),_wpnonce_activity_filter:jq("#_wpnonce_activity_filter").val(),scope:e,filter:t},function(e){jq(".widget_bp_activity_widget h2 span.ajax-loader").hide(),jq("div.activity").fadeOut(100,function(){jq(this).html(e.contents),jq(this).fadeIn(100),bp_legacy_theme_hide_comments()}),null!=e.feed_url&&jq(".directory #subnav li.feed a, .home-page #subnav li.feed a").attr("href",e.feed_url),jq(".item-list-tabs li.selected").removeClass("loading")},"json")}function bp_legacy_theme_hide_comments(){var e,t,i,a=jq("div.activity-comments");return a.length?void a.each(function(){jq(this).children("ul").children("li").length<5||(comments_div=jq(this),e=comments_div.parents("#activity-stream > li"),t=jq(this).children("ul").children("li"),i=" ",jq("#"+e.attr("id")+" a.acomment-reply span").length&&(i=jq("#"+e.attr("id")+" a.acomment-reply span").html()),t.each(function(a){a<t.length-5&&(jq(this).addClass("hidden"),jq(this).toggle(),a||jq(this).before('<li class="show-all"><a href="#'+e.attr("id")+'/show-all/" title="'+BP_DTheme.show_all_comments+'">'+BP_DTheme.show_x_comments.replace("%d",i)+"</a></li>"))}))}):!1}function checkAll(){var e,t=document.getElementsByTagName("input");for(e=0;e<t.length;e++)"checkbox"===t[e].type&&(""===$("check_all").checked?t[e].checked="":t[e].checked="checked")}function clear(e){if(e=document.getElementById(e)){var t=e.getElementsByTagName("INPUT"),i=e.getElementsByTagName("OPTION"),a=0;if(t)for(a=0;a<t.length;a++)t[a].checked="";if(i)for(a=0;a<i.length;a++)i[a].selected=!1}}function bp_get_cookies(){var e,t,i,a,s,n=document.cookie.split(";"),o={},r="bp-";for(e=0;e<n.length;e++)t=n[e],i=t.indexOf("="),a=jq.trim(unescape(t.slice(0,i))),s=unescape(t.slice(i+1)),0===a.indexOf(r)&&(o[a]=s);return encodeURIComponent(jq.param(o))}var jq=jQuery,bp_ajax_request=null,newest_activities="",activity_last_recorded=0;jq(document).ready(function(){"-1"===window.location.search.indexOf("new")&&jq("div.forums").length?jq("#new-topic-post").hide():jq("#new-topic-post").show(),bp_init_activity();var e=["members","groups","blogs","forums","group_members"],t=jq("#whats-new");if(bp_init_objects(e),t.length&&bp_get_querystring("r")){var i=t.val();jq("#whats-new-options").animate({height:"50px"}),t.animate({height:"50px"}),jq.scrollTo(t,500,{offset:-125,easing:"swing"}),t.val("").focus().val(i)}if(t.focus(function(){jq("#whats-new-options").animate({height:"50px"}),jq("#whats-new-form textarea").animate({height:"50px"}),jq("#aw-whats-new-submit").prop("disabled",!1);var e=jq("form#whats-new-form"),t=jq("#activity-all");e.hasClass("submitted")&&e.removeClass("submitted"),t.length&&(t.hasClass("selected")?"-1"!==jq("#activity-filter-select select").val()&&(jq("#activity-filter-select select").val("-1"),jq("#activity-filter-select select").trigger("change")):(jq("#activity-filter-select select").val("-1"),t.children("a").trigger("click")))}),t.blur(function(){document.activeElement!==this&&(this.value.match(/\S+/)||(this.value="",jq("#whats-new-options").animate({height:"50px"}),jq("form#whats-new-form textarea").animate({height:"35px"}),jq("#aw-whats-new-submit").prop("disabled",!0)))}),jq("#aw-whats-new-submit").on("click",function(){var e=0,t=jq(this),i=t.closest("form#whats-new-form");return i.children().each(function(){(jq.nodeName(this,"textarea")||jq.nodeName(this,"input"))&&jq(this).prop("disabled",!0)}),jq("div.error").remove(),t.addClass("loading"),t.prop("disabled",!0),i.addClass("submitted"),object="",item_id=jq("#whats-new-post-in").val(),content=jq("#whats-new").val(),firstrow=jq("#buddypress ul.activity-list li").first(),activity_row=firstrow,timestamp=null,firstrow.length&&(activity_row.hasClass("load-newest")&&(activity_row=firstrow.next()),timestamp=activity_row.prop("class").match(/date-recorded-([0-9]+)/)),timestamp&&(e=timestamp[1]),item_id>0&&(object=jq("#whats-new-post-object").val()),jq.post(ajaxurl,{action:"post_update",cookie:bp_get_cookies(),_wpnonce_post_update:jq("#_wpnonce_post_update").val(),content:content,object:object,item_id:item_id,since:e,_bp_as_nonce:jq("#_bp_as_nonce").val()||""},function(t){if(i.children().each(function(){(jq.nodeName(this,"textarea")||jq.nodeName(this,"input"))&&jq(this).prop("disabled",!1)}),t[0]+t[1]==="-1")i.prepend(t.substr(2,t.length)),jq("#"+i.attr("id")+" div.error").hide().fadeIn(200);else{if(0===jq("ul.activity-list").length&&(jq("div.error").slideUp(100).remove(),jq("#message").slideUp(100).remove(),jq("div.activity").append('<ul id="activity-stream" class="activity-list item-list">')),firstrow.hasClass("load-newest")&&firstrow.remove(),jq("#activity-stream").prepend(t),e||jq("#activity-stream li:first").addClass("new-update just-posted"),0!==jq("#latest-update").length){var a=jq("#activity-stream li.new-update .activity-content .activity-inner p").html(),s=jq("#activity-stream li.new-update .activity-content .activity-header p a.view").attr("href"),n=jq("#activity-stream li.new-update .activity-content .activity-inner p").text(),o="";""!==n&&(o=a+" "),o+='<a href="'+s+'" rel="nofollow">'+BP_DTheme.view+"</a>",jq("#latest-update").slideUp(300,function(){jq("#latest-update").html(o),jq("#latest-update").slideDown(300)})}jq("li.new-update").hide().slideDown(300),jq("li.new-update").removeClass("new-update"),jq("#whats-new").val(""),newest_activities="",activity_last_recorded=0}jq("#whats-new-options").animate({height:"0px"}),jq("#whats-new-form textarea").animate({height:"20px"}),jq("#aw-whats-new-submit").prop("disabled",!0).removeClass("loading")}),!1}),jq("div.activity-type-tabs").on("click",function(e){var t,i,a=jq(e.target).parent();if("STRONG"===e.target.nodeName||"SPAN"===e.target.nodeName)a=a.parent();else if("A"!==e.target.nodeName)return!1;return jq.cookie("bp-activity-oldestpage",1,{path:"/"}),t=a.attr("id").substr(9,a.attr("id").length),i=jq("#activity-filter-select select").val(),"mentions"===t&&jq("#"+a.attr("id")+" a strong").remove(),bp_activity_request(t,i),!1}),jq("#activity-filter-select select").change(function(){var e,t=jq("div.activity-type-tabs li.selected"),i=jq(this).val();return e=t.length?t.attr("id").substr(9,t.attr("id").length):null,bp_activity_request(e,i),!1}),jq("div.activity").on("click",function(e){var t,i,a,s,n,o,r,l,c,d,p=jq(e.target);return p.hasClass("fav")||p.hasClass("unfav")?(t=p.hasClass("fav")?"fav":"unfav",i=p.closest(".activity-item"),a=i.attr("id").substr(9,i.attr("id").length),p.addClass("loading"),jq.post(ajaxurl,{action:"activity_mark_"+t,cookie:bp_get_cookies(),id:a},function(e){p.removeClass("loading"),p.fadeOut(200,function(){jq(this).html(e),jq(this).attr("title","fav"===t?BP_DTheme.remove_fav:BP_DTheme.mark_as_fav),jq(this).fadeIn(200)}),"fav"===t?(jq(".item-list-tabs #activity-favs-personal-li").length||(jq(".item-list-tabs #activity-favorites").length||jq(".item-list-tabs ul #activity-mentions").before('<li id="activity-favorites"><a href="#">'+BP_DTheme.my_favs+" <span>0</span></a></li>"),jq(".item-list-tabs ul #activity-favorites span").html(Number(jq(".item-list-tabs ul #activity-favorites span").html())+1)),p.removeClass("fav"),p.addClass("unfav")):(p.removeClass("unfav"),p.addClass("fav"),jq(".item-list-tabs ul #activity-favorites span").html(Number(jq(".item-list-tabs ul #activity-favorites span").html())-1),Number(jq(".item-list-tabs ul #activity-favorites span").html())||(jq(".item-list-tabs ul #activity-favorites").hasClass("selected")&&bp_activity_request(null,null),jq(".item-list-tabs ul #activity-favorites").remove())),"activity-favorites"===jq(".item-list-tabs li.selected").attr("id")&&p.closest(".activity-item").slideUp(100)}),!1):p.hasClass("delete-activity")?(s=p.parents("div.activity ul li"),n=s.attr("id").substr(9,s.attr("id").length),o=p.attr("href"),r=o.split("_wpnonce="),l=s.prop("class").match(/date-recorded-([0-9]+)/),r=r[1],p.addClass("loading"),jq.post(ajaxurl,{action:"delete_activity",cookie:bp_get_cookies(),id:n,_wpnonce:r},function(e){e[0]+e[1]==="-1"?(s.prepend(e.substr(2,e.length)),s.children("#message").hide().fadeIn(300)):(s.slideUp(300),l&&activity_last_recorded===l[1]&&(newest_activities="",activity_last_recorded=0))}),!1):p.hasClass("spam-activity")?(s=p.parents("div.activity ul li"),l=s.prop("class").match(/date-recorded-([0-9]+)/),p.addClass("loading"),jq.post(ajaxurl,{action:"bp_spam_activity",cookie:encodeURIComponent(document.cookie),id:s.attr("id").substr(9,s.attr("id").length),_wpnonce:p.attr("href").split("_wpnonce=")[1]},function(e){e[0]+e[1]==="-1"?(s.prepend(e.substr(2,e.length)),s.children("#message").hide().fadeIn(300)):(s.slideUp(300),l&&activity_last_recorded===l[1]&&(newest_activities="",activity_last_recorded=0))}),!1):p.parent().hasClass("load-more")?(bp_ajax_request&&bp_ajax_request.abort(),jq("#buddypress li.load-more").addClass("loading"),null===jq.cookie("bp-activity-oldestpage")&&jq.cookie("bp-activity-oldestpage",1,{path:"/"}),c=1*jq.cookie("bp-activity-oldestpage")+1,d=[],jq(".activity-list li.just-posted").each(function(){d.push(jq(this).attr("id").replace("activity-",""))}),load_more_args={action:"activity_get_older_updates",cookie:bp_get_cookies(),page:c,exclude_just_posted:d.join(",")},load_more_search=bp_get_querystring("s"),load_more_search&&(load_more_args.search_terms=load_more_search),bp_ajax_request=jq.post(ajaxurl,load_more_args,function(e){jq("#buddypress li.load-more").removeClass("loading"),jq.cookie("bp-activity-oldestpage",c,{path:"/"}),jq("#buddypress ul.activity-list").append(e.contents),p.parent().hide()},"json"),!1):void(p.parent().hasClass("load-newest")&&(e.preventDefault(),p.parent().hide(),activity_html=jq.parseHTML(newest_activities),jq.each(activity_html,function(e,t){"LI"===t.nodeName&&jq(t).hasClass("just-posted")&&jq("#"+jq(t).attr("id")).length&&jq("#"+jq(t).attr("id")).remove()}),jq("#buddypress ul.activity-list").prepend(newest_activities),newest_activities=""))}),jq("div.activity").on("click",".activity-read-more a",function(e){var t,i,a=jq(e.target),s=a.parent().attr("id").split("-"),n=s[3],o=s[0];return t="acomment"===o?"acomment-content":"activity-inner",i=jq("#"+o+"-"+n+" ."+t+":first"),jq(a).addClass("loading"),jq.post(ajaxurl,{action:"get_single_activity_content",activity_id:n},function(e){jq(i).slideUp(300).html(e).slideDown(300)}),!1}),jq("form.ac-form").hide(),jq(".activity-comments").length&&bp_legacy_theme_hide_comments(),jq("div.activity").on("click",function(e){var t,i,a,s,n,o,r,l,c,d,p,m,h,j,u,q,v=jq(e.target);return v.hasClass("acomment-reply")||v.parent().hasClass("acomment-reply")?(v.parent().hasClass("acomment-reply")&&(v=v.parent()),t=v.attr("id"),i=t.split("-"),a=i[2],s=v.attr("href").substr(10,v.attr("href").length),n=jq("#ac-form-"+a),n.css("display","none"),n.removeClass("root"),jq(".ac-form").hide(),n.children("div").each(function(){jq(this).hasClass("error")&&jq(this).hide()}),"comment"!==i[1]?jq("#acomment-"+s).append(n):jq("#activity-"+a+" .activity-comments").append(n),n.parent().hasClass("activity-comments")&&n.addClass("root"),n.slideDown(200),jq.scrollTo(n,500,{offset:-100,easing:"swing"}),jq("#ac-form-"+i[2]+" textarea").focus(),!1):"ac_form_submit"===v.attr("name")?(n=v.parents("form"),o=n.parent(),r=n.attr("id").split("-"),o.hasClass("activity-comments")?c=r[2]:(l=o.attr("id").split("-"),c=l[1]),content=jq("#"+n.attr("id")+" textarea"),jq("#"+n.attr("id")+" div.error").hide(),v.addClass("loading").prop("disabled",!0),content.addClass("loading").prop("disabled",!0),d={action:"new_activity_comment",cookie:bp_get_cookies(),_wpnonce_new_activity_comment:jq("#_wpnonce_new_activity_comment").val(),comment_id:c,form_id:r[2],content:content.val()},p=jq("#_bp_as_nonce_"+c).val(),p&&(d["_bp_as_nonce_"+c]=p),jq.post(ajaxurl,d,function(e){if(v.removeClass("loading"),content.removeClass("loading"),e[0]+e[1]==="-1")n.append(jq(e.substr(2,e.length)).hide().fadeIn(200));else{var t=n.parent();n.fadeOut(200,function(){0===t.children("ul").length&&(t.hasClass("activity-comments")?t.prepend("<ul></ul>"):t.append("<ul></ul>"));var i=jq.trim(e);t.children("ul").append(jq(i).hide().fadeIn(200)),n.children("textarea").val(""),t.parent().addClass("has-comments")}),jq("#"+n.attr("id")+" textarea").val(""),jq("#activity-"+r[2]+" a.acomment-reply span").html(Number(jq("#activity-"+r[2]+" a.acomment-reply span").html())+1),m=t.find(".show-all").find("a"),m&&(h=jq("li#activity-"+r[2]+" a.acomment-reply span").html(),m.html(BP_DTheme.show_x_comments.replace("%d",h)))}jq(v).prop("disabled",!1),jq(content).prop("disabled",!1)}),!1):v.hasClass("acomment-delete")?(j=v.attr("href"),u=v.parent().parent(),n=u.parents("div.activity-comments").children("form"),q=j.split("_wpnonce="),q=q[1],c=j.split("cid="),c=c[1].split("&"),c=c[0],v.addClass("loading"),jq(".activity-comments ul .error").remove(),u.parents(".activity-comments").append(n),jq.post(ajaxurl,{action:"delete_activity_comment",cookie:bp_get_cookies(),_wpnonce:q,id:c},function(e){if(e[0]+e[1]==="-1")u.prepend(jq(e.substr(2,e.length)).hide().fadeIn(200));else{var t,i,a,s=jq("#"+u.attr("id")+" ul").children("li"),n=0;jq(s).each(function(){jq(this).is(":hidden")||n++}),u.fadeOut(200,function(){u.remove()}),t=jq("#"+u.parents("#activity-stream > li").attr("id")+" a.acomment-reply span"),i=t.html()-(1+n),t.html(i),a=u.siblings(".show-all").find("a"),a&&a.html(BP_DTheme.show_x_comments.replace("%d",i)),0===i&&jq(u.parents("#activity-stream > li")).removeClass("has-comments")}}),!1):v.hasClass("spam-activity-comment")?(j=v.attr("href"),u=v.parent().parent(),v.addClass("loading"),jq(".activity-comments ul div.error").remove(),u.parents(".activity-comments").append(u.parents(".activity-comments").children("form")),jq.post(ajaxurl,{action:"bp_spam_activity_comment",cookie:encodeURIComponent(document.cookie),_wpnonce:j.split("_wpnonce=")[1],id:j.split("cid=")[1].split("&")[0]},function(e){if(e[0]+e[1]==="-1")u.prepend(jq(e.substr(2,e.length)).hide().fadeIn(200));else{var t,i=jq("#"+u.attr("id")+" ul").children("li"),a=0;jq(i).each(function(){jq(this).is(":hidden")||a++}),u.fadeOut(200),t=u.parents("#activity-stream > li"),jq("#"+t.attr("id")+" a.acomment-reply span").html(jq("#"+t.attr("id")+" a.acomment-reply span").html()-(1+a))}}),!1):v.parent().hasClass("show-all")?(v.parent().addClass("loading"),setTimeout(function(){v.parent().parent().children("li").fadeIn(200,function(){v.parent().remove()})},600),!1):v.hasClass("ac-reply-cancel")?(jq(v).closest(".ac-form").slideUp(200),!1):void 0}),jq(document).keydown(function(e){if(e=e||window.event,e.target?element=e.target:e.srcElement&&(element=e.srcElement),3===element.nodeType&&(element=element.parentNode),e.ctrlKey!==!0&&e.altKey!==!0&&e.metaKey!==!0){var t=e.keyCode?e.keyCode:e.which;27===t&&"TEXTAREA"===element.tagName&&jq(element).hasClass("ac-input")&&jq(element).parent().parent().parent().slideUp(200)}}),jq(".dir-search, .groups-members-search").on("click",function(e){if(!jq(this).hasClass("no-ajax")){var t,i,a,s=jq(e.target);return"submit"===s.attr("type")?(t=jq(".item-list-tabs li.selected").attr("id").split("-"),i=t[0],a=null,"groups-members-search"===e.currentTarget.className&&(i="group_members",a="groups/single/members"),bp_filter_request(i,jq.cookie("bp-"+i+"-filter"),jq.cookie("bp-"+i+"-scope"),"div."+i,s.parent().children("label").children("input").val(),1,jq.cookie("bp-"+i+"-extras"),null,a),!1):void 0}}),jq("div.item-list-tabs").on("click",function(e){if(!jq(this).hasClass("no-ajax")&&!jq(e.target).hasClass("no-ajax")){var t,i,a,s,n,o="SPAN"===e.target.nodeName?e.target.parentNode:e.target,r=jq(o).parent();return"LI"!==r[0].nodeName||r.hasClass("last")?void 0:(t=r.attr("id").split("-"),i=t[0],"activity"===i?!1:(a=t[1],s=jq("#"+i+"-order-select select").val(),n=jq("#"+i+"_search").val(),bp_filter_request(i,s,a,"div."+i,n,1,jq.cookie("bp-"+i+"-extras")),!1))}}),jq("li.filter select").change(function(){var e,t,i,a,s,n,o,r;return e=jq(jq(".item-list-tabs li.selected").length?".item-list-tabs li.selected":this),t=e.attr("id").split("-"),i=t[0],a=t[1],s=jq(this).val(),n=!1,o=null,jq(".dir-search input").length&&(n=jq(".dir-search input").val()),r=jq(".groups-members-search input"),r.length&&(n=r.val(),i="members",a="groups"),"members"===i&&"groups"===a&&(i="group_members",o="groups/single/members"),"friends"===i&&(i="members"),bp_filter_request(i,s,a,"div."+i,n,1,jq.cookie("bp-"+i+"-extras"),null,o),!1}),jq("#buddypress").on("click",function(e){var t,i,a,s,n,o,r,l,c,d=jq(e.target);return d.hasClass("button")?!0:d.parent().parent().hasClass("pagination")&&!d.parent().parent().hasClass("no-ajax")?d.hasClass("dots")||d.hasClass("current")?!1:(t=jq(jq(".item-list-tabs li.selected").length?".item-list-tabs li.selected":"li.filter select"),i=t.attr("id").split("-"),a=i[0],s=!1,n=jq(d).closest(".pagination-links").attr("id"),o=null,r=d.attr("href").split("="),r=r[1],jq("div.dir-search input").length&&(s=jq(".dir-search input").val(),!s&&bp_get_querystring("s")&&(s=jq(".dir-search input").prop("placeholder"))),l=jq(".groups-members-search input"),l.length&&(s=l.val(),a="members"),"members"===a&&"groups"===i[1]&&(a="group_members",o="groups/single/members"),"admin"===a&&jq("body").hasClass("membership-requests")&&(a="requests"),c=-1!==n.indexOf("pag-bottom")?"pag-bottom":null,bp_filter_request(a,jq.cookie("bp-"+a+"-filter"),jq.cookie("bp-"+a+"-scope"),"div."+a,s,r,jq.cookie("bp-"+a+"-extras"),c,o),!1):void 0}),jq("a.show-hide-new").on("click",function(){return jq("#new-topic-post").length?(jq("#new-topic-post").is(":visible")?jq("#new-topic-post").slideUp(200):jq("#new-topic-post").slideDown(200,function(){jq("#topic_title").focus()}),!1):!1}),jq("#submit_topic_cancel").on("click",function(){return jq("#new-topic-post").length?(jq("#new-topic-post").slideUp(200),!1):!1}),jq("#forum-directory-tags a").on("click",function(){return bp_filter_request("forums","tags",jq.cookie("bp-forums-scope"),"div.forums",jq(this).html().replace(/&nbsp;/g,"-"),1,jq.cookie("bp-forums-extras")),!1}),jq("#send-invite-form").on("click","#invite-list input",function(){var e,t,i=jq("#send-invite-form > .invite").length;jq(".ajax-loader").toggle(),i&&jq(this).parents("ul").find("input").prop("disabled",!0),e=jq(this).val(),t=jq(this).prop("checked")===!0?"invite":"uninvite",i||jq(".item-list-tabs li.selected").addClass("loading"),jq.post(ajaxurl,{action:"groups_invite_user",friend_action:t,cookie:bp_get_cookies(),_wpnonce:jq("#_wpnonce_invite_uninvite_user").val(),friend_id:e,group_id:jq("#group_id").val()},function(a){jq("#message")&&jq("#message").hide(),i?bp_filter_request("invite","bp-invite-filter","bp-invite-scope","div.invite",!1,1,"","",""):(jq(".ajax-loader").toggle(),"invite"===t?jq("#friend-list").append(a):"uninvite"===t&&jq("#friend-list li#uid-"+e).remove(),jq(".item-list-tabs li.selected").removeClass("loading"))})}),jq("#send-invite-form").on("click","a.remove",function(){var e=jq("#send-invite-form > .invite").length,t=jq(this).attr("id");return jq(".ajax-loader").toggle(),t=t.split("-"),t=t[1],jq.post(ajaxurl,{action:"groups_invite_user",friend_action:"uninvite",cookie:bp_get_cookies(),_wpnonce:jq("#_wpnonce_invite_uninvite_user").val(),friend_id:t,group_id:jq("#group_id").val()},function(i){e?bp_filter_request("invite","bp-invite-filter","bp-invite-scope","div.invite",!1,1,"","",""):(jq(".ajax-loader").toggle(),jq("#friend-list #uid-"+t).remove(),jq("#invite-list #f-"+t).prop("checked",!1))}),!1}),jq(".visibility-toggle-link").on("click",function(e){e.preventDefault(),jq(this).parent().hide().addClass("field-visibility-settings-hide").siblings(".field-visibility-settings").show().addClass("field-visibility-settings-open")}),jq(".field-visibility-settings-close").on("click",function(e){e.preventDefault();var t=jq(this).parent(),i=t.find("input:checked").parent().text();t.hide().removeClass("field-visibility-settings-open").siblings(".field-visibility-settings-toggle").children(".current-visibility-level").text(i).end().show().removeClass("field-visibility-settings-hide")}),jq("#profile-edit-form input:not(:submit), #profile-edit-form textarea, #profile-edit-form select, #signup_form input:not(:submit), #signup_form textarea, #signup_form select").change(function(){var e=!0;jq("#profile-edit-form input:submit, #signup_form input:submit").on("click",function(){e=!1}),window.onbeforeunload=function(t){return e?BP_DTheme.unsaved_changes:void 0}}),jq("#friend-list a.accept, #friend-list a.reject").on("click",function(){var e,t=jq(this),i=jq(this).parents("#friend-list li"),a=jq(this).parents("li div.action"),s=i.attr("id").substr(11,i.attr("id").length),n=t.attr("href"),o=n.split("_wpnonce=")[1];return jq(this).hasClass("accepted")||jq(this).hasClass("rejected")?!1:(jq(this).hasClass("accept")?(e="accept_friendship",a.children("a.reject").css("visibility","hidden")):(e="reject_friendship",a.children("a.accept").css("visibility","hidden")),t.addClass("loading"),jq.post(ajaxurl,{action:e,cookie:bp_get_cookies(),id:s,_wpnonce:o},function(e){t.removeClass("loading"),e[0]+e[1]==="-1"?(i.prepend(e.substr(2,e.length)),i.children("#message").hide().fadeIn(200)):t.fadeOut(100,function(){jq(this).hasClass("accept")?(a.children("a.reject").hide(),jq(this).html(BP_DTheme.accepted).contents().unwrap()):(a.children("a.accept").hide(),jq(this).html(BP_DTheme.rejected).contents().unwrap())})}),!1)}),jq("#members-dir-list, #members-group-list, #item-header").on("click",".friendship-button a",function(){jq(this).parent().addClass("loading");var e=jq(this).attr("id"),t=jq(this).attr("href"),i=jq(this);return e=e.split("-"),e=e[1],t=t.split("?_wpnonce="),t=t[1].split("&"),t=t[0],jq.post(ajaxurl,{action:"addremove_friend",cookie:bp_get_cookies(),fid:e,_wpnonce:t},function(e){var t=i.attr("rel");parentdiv=i.parent(),"add"===t?jq(parentdiv).fadeOut(200,function(){parentdiv.removeClass("add_friend"),parentdiv.removeClass("loading"),parentdiv.addClass("pending_friend"),parentdiv.fadeIn(200).html(e)}):"remove"===t&&jq(parentdiv).fadeOut(200,function(){parentdiv.removeClass("remove_friend"),parentdiv.removeClass("loading"),parentdiv.addClass("add"),parentdiv.fadeIn(200).html(e)})}),!1}),jq("#buddypress").on("click",".group-button .leave-group",function(){return!1===confirm(BP_DTheme.leave_group_confirm)?!1:void 0}),jq("#groups-dir-list").on("click",".group-button a",function(){var e=jq(this).parent().attr("id"),t=jq(this).attr("href"),i=jq(this);return e=e.split("-"),e=e[1],t=t.split("?_wpnonce="),t=t[1].split("&"),t=t[0],i.hasClass("leave-group")&&!1===confirm(BP_DTheme.leave_group_confirm)?!1:(jq.post(ajaxurl,{action:"joinleave_group",cookie:bp_get_cookies(),gid:e,_wpnonce:t},function(e){var t=i.parent();jq("body.directory").length?jq(t).fadeOut(200,function(){t.fadeIn(200).html(e);var a=jq("#groups-personal span"),s=1;i.hasClass("leave-group")?(t.hasClass("hidden")&&t.closest("li").slideUp(200),s=0):i.hasClass("request-membership")&&(s=!1),a.length&&s!==!1&&(s?a.text((a.text()>>0)+1):a.text((a.text()>>0)-1))}):location.href=location.href}),!1)}),jq("#buddypress").on("click",".pending",function(){return!1}),jq("body").hasClass("register")){var a=jq("#signup_with_blog");a.prop("checked")||jq("#blog-details").toggle(),a.change(function(){jq("#blog-details").toggle()})}jq(".message-search").on("click",function(e){if(!jq(this).hasClass("no-ajax")){var t,i=jq(e.target);return"submit"===i.attr("type")||"button"===i.attr("type")?(t="messages",bp_filter_request(t,jq.cookie("bp-"+t+"-filter"),jq.cookie("bp-"+t+"-scope"),"div."+t,jq("#messages_search").val(),1,jq.cookie("bp-"+t+"-extras")),!1):void 0}}),jq("#send_reply_button").click(function(){var e=jq("#messages_order").val()||"ASC",t=jq("#message-recipients").offset(),i=jq("#send_reply_button");return jq(i).addClass("loading"),jq.post(ajaxurl,{action:"messages_send_reply",cookie:bp_get_cookies(),_wpnonce:jq("#send_message_nonce").val(),content:jq("#message_content").val(),send_to:jq("#send_to").val(),subject:jq("#subject").val(),thread_id:jq("#thread_id").val()},function(a){a[0]+a[1]==="-1"?jq("#send-reply").prepend(a.substr(2,a.length)):(jq("#send-reply #message").remove(),jq("#message_content").val(""),"ASC"===e?jq("#send-reply").before(a):(jq("#message-recipients").after(a),jq(window).scrollTop(t.top)),jq(".new-message").hide().slideDown(200,function(){jq(".new-message").removeClass("new-message")})),jq(i).removeClass("loading")}),!1}),jq("#mark_as_read, #mark_as_unread").click(function(){var e,t,i,a,s,n,o,r,l="",c=jq('#message-threads tr td input[type="checkbox"]');return"mark_as_unread"===jq(this).attr("id")?(e="read",t="unread",i=1,a=0,s="inline",n="messages_markunread"):(e="unread",t="read",i=0,a=1,s="none",n="messages_markread"),c.each(function(a){jq(this).is(":checked")&&jq("#m-"+jq(this).attr("value")).hasClass(e)&&(l+=jq(this).attr("value"),jq("#m-"+jq(this).attr("value")).removeClass(e),jq("#m-"+jq(this).attr("value")).addClass(t),r=jq("#m-"+jq(this).attr("value")+" td span.unread-count").html(),jq("#m-"+jq(this).attr("value")+" td span.unread-count").html(i),jq("#m-"+jq(this).attr("value")+" td span.unread-count").css("display",s),o=jq("tr.unread").length,jq("#user-messages span").html(o),a!==c.length-1&&(l+=","))}),jq.post(ajaxurl,{action:n,thread_ids:l}),!1}),jq("body.messages #item-body div.messages").on("change","#message-type-select",function(){var e=this.value,t=jq('td input[type="checkbox"]'),i="checked";switch(t.each(function(e){t[e].checked=""}),e){case"unread":t=jq('tr.unread td input[type="checkbox"]');break;case"read":t=jq('tr.read td input[type="checkbox"]');break;case"":i=""}t.each(function(e){t[e].checked=i})}),jq("body.messages #item-body div.messages").on("click",".messages-options-nav a",function(){return-1!==jq.inArray(this.id,Array("delete_sentbox_messages","delete_inbox_messages"))?(checkboxes_tosend="",checkboxes=jq('#message-threads tr td input[type="checkbox"]'),jq("#message").remove(),jq(this).addClass("loading"),jq(checkboxes).each(function(e){jq(this).is(":checked")&&(checkboxes_tosend+=jq(this).attr("value")+",")}),""===checkboxes_tosend?(jq(this).removeClass("loading"),!1):(jq.post(ajaxurl,{action:"messages_delete",thread_ids:checkboxes_tosend},function(e){e[0]+e[1]==="-1"?jq("#message-threads").prepend(e.substr(2,e.length)):(jq("#message-threads").before('<div id="message" class="updated"><p>'+e+"</p></div>"),jq(checkboxes).each(function(e){jq(this).is(":checked")&&(jq(this).attr("checked",!1),jq(this).parent().parent().fadeOut(150))})),jq("#message").hide().slideDown(150),jq("#delete_inbox_messages, #delete_sentbox_messages").removeClass("loading")}),!1)):void 0}),jq("#select-all-messages").click(function(e){this.checked?jq(".message-check").each(function(){this.checked=!0}):jq(".message-check").each(function(){this.checked=!1})}),jq("#messages-bulk-manage").attr("disabled","disabled"),jq("#messages-select").on("change",function(){jq("#messages-bulk-manage").attr("disabled",jq(this).val().length<=0)}),jq("#select-all-notifications").click(function(e){this.checked?jq(".notification-check").each(function(){this.checked=!0}):jq(".notification-check").each(function(){this.checked=!1})}),jq("#notification-bulk-manage").attr("disabled","disabled"),jq("#notification-select").on("change",function(){jq("#notification-bulk-manage").attr("disabled",jq(this).val().length<=0)}),jq("#close-notice").on("click",function(){return jq(this).addClass("loading"),jq("#sidebar div.error").remove(),jq.post(ajaxurl,{action:"messages_close_notice",notice_id:jq(".notice").attr("rel").substr(2,jq(".notice").attr("rel").length)},function(e){jq("#close-notice").removeClass("loading"),e[0]+e[1]==="-1"?(jq(".notice").prepend(e.substr(2,e.length)),jq("#sidebar div.error").hide().fadeIn(200)):jq(".notice").slideUp(100)}),!1}),jq("#wp-admin-bar ul.main-nav li, #nav li").mouseover(function(){jq(this).addClass("sfhover")}),jq("#wp-admin-bar ul.main-nav li, #nav li").mouseout(function(){jq(this).removeClass("sfhover")}),jq("#wp-admin-bar-logout, a.logout").on("click",function(){jq.removeCookie("bp-activity-scope",{path:"/"}),jq.removeCookie("bp-activity-filter",{path:"/"}),jq.removeCookie("bp-activity-oldestpage",{path:"/"});var e=["members","groups","blogs","forums"];jq(e).each(function(t){jq.removeCookie("bp-"+e[t]+"-scope",{path:"/"}),jq.removeCookie("bp-"+e[t]+"-filter",{path:"/"}),jq.removeCookie("bp-"+e[t]+"-extras",{path:"/"})})}),jq("body").hasClass("no-js")&&jq("body").attr("class",jq("body").attr("class").replace(/no-js/,"js")),"undefined"!=typeof wp&&"undefined"!=typeof wp.heartbeat&&"undefined"!=typeof BP_DTheme.pulse&&(wp.heartbeat.interval(Number(BP_DTheme.pulse)),jq.fn.extend({"heartbeat-send":function(){return this.bind("heartbeat-send.buddypress")}}));var s=0;jq(document).on("heartbeat-send.buddypress",function(e,t){s=0,jq("#buddypress ul.activity-list li").first().prop("id")&&(timestamp=jq("#buddypress ul.activity-list li").first().prop("class").match(/date-recorded-([0-9]+)/),timestamp&&(s=timestamp[1])),(0===activity_last_recorded||Number(s)>activity_last_recorded)&&(activity_last_recorded=Number(s)),t.bp_activity_last_recorded=activity_last_recorded,last_recorded_search=bp_get_querystring("s"),last_recorded_search&&(t.bp_activity_last_recorded_search_terms=last_recorded_search)}),jq(document).on("heartbeat-tick",function(e,t){t.bp_activity_newest_activities&&(newest_activities=t.bp_activity_newest_activities.activities+newest_activities,
activity_last_recorded=Number(t.bp_activity_newest_activities.last_recorded),jq("#buddypress ul.activity-list li").first().hasClass("load-newest")||jq("#buddypress ul.activity-list").prepend('<li class="load-newest"><a href="#newest">'+BP_DTheme.newest+"</a></li>"))})});